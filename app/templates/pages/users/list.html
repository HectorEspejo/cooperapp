{% extends "base.html" %}

{% block title %}Usuarios - CooperApp{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Gestion de Usuarios</h1>
</div>

<div class="filter-bar">
    <div class="filter-group">
        <select onchange="window.location.href='/usuarios?rol='+this.value" class="form-select">
            <option value="">Todos los roles</option>
            {% for r in roles %}
            <option value="{{ r.value }}" {% if filters.rol == r.value %}selected{% endif %}>{{ r.value|replace('_', ' ')|title }}</option>
            {% endfor %}
        </select>
        <select onchange="window.location.href='/usuarios?activo='+this.value" class="form-select">
            <option value="">Todos</option>
            <option value="true" {% if filters.activo == 'true' %}selected{% endif %}>Activos</option>
            <option value="false" {% if filters.activo == 'false' %}selected{% endif %}>Inactivos</option>
        </select>
    </div>
    <div class="search-box">
        <form action="/usuarios" method="get">
            <input type="text" name="search" placeholder="Buscar usuario..." value="{{ filters.search or '' }}" class="form-control">
        </form>
    </div>
</div>

<div class="card">
    <table class="table">
        <thead>
            <tr>
                <th>Usuario</th>
                <th>Email</th>
                <th>Rol</th>
                <th>Estado</th>
                <th>Ultimo acceso</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody id="users-table">
            {% for u in users %}
            {% include "partials/users/user_row.html" %}
            {% endfor %}
        </tbody>
    </table>

    {% if not users %}
    <div class="empty-state">
        <p>No se encontraron usuarios.</p>
    </div>
    {% endif %}
</div>
{% endblock %}
