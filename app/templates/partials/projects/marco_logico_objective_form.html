<div class="modal-overlay" onclick="closeIndicatorModal(event)">
    <div class="ml-modal" onclick="event.stopPropagation()">
        <div class="modal-header">
            <h3>{% if mode == 'edit' %}Editar Objetivo Especifico{% else %}Nuevo Objetivo Especifico{% endif %}</h3>
            <button class="btn-close" onclick="closeIndicatorModal()">&times;</button>
        </div>

        <form
            class="modal-body"
            {% if mode == 'edit' %}
            hx-put="/projects/objectives/{{ objective.id }}"
            {% else %}
            hx-post="/projects/{{ project_id }}/marco-logico/objectives"
            {% endif %}
            hx-target="#marco-logico-content"
            hx-swap="innerHTML"
            hx-on::after-request="closeIndicatorModal()"
        >
            <div class="form-grid">
                <div class="form-group" style="max-width: 120px;">
                    <label>Numero</label>
                    <input
                        type="number"
                        name="numero"
                        min="1"
                        value="{{ objective.numero if objective else next_numero }}"
                        required
                    >
                </div>
                <div class="form-group" style="flex: 1;">
                    <label>Descripcion</label>
                    <input
                        type="text"
                        name="descripcion"
                        value="{{ objective.descripcion if objective else '' }}"
                        placeholder="Descripcion del objetivo especifico..."
                        required
                    >
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeIndicatorModal()">
                    Cancelar
                </button>
                <button type="submit" class="btn btn-primary">
                    {% if mode == 'edit' %}Guardar Cambios{% else %}Crear Objetivo{% endif %}
                </button>
            </div>
        </form>
    </div>
</div>

<script>
function closeIndicatorModal(event) {
    if (event && event.target !== event.currentTarget) return;
    document.getElementById('indicator-modal-container').classList.remove('active');
    document.getElementById('indicator-modal-container').innerHTML = '';
}
</script>
