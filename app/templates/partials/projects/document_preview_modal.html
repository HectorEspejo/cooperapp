{% set _t = t if t is defined else None %}
<div class="modal-overlay" onclick="closeDocumentPreview()">
    <div class="document-preview-modal" onclick="event.stopPropagation()">
        <div class="modal-header">
            <h3>{{ document.original_filename }}</h3>
            <button type="button" class="btn-close" onclick="closeDocumentPreview()">&times;</button>
        </div>
        <div class="modal-body preview-body">
            {% if document.is_image %}
            <div class="preview-image">
                <img src="/api/documents/{{ document.id }}/download" alt="{{ document.original_filename }}">
            </div>
            {% elif document.is_pdf %}
            <div class="preview-pdf">
                <iframe src="/api/documents/{{ document.id }}/download" type="application/pdf"></iframe>
            </div>
            {% else %}
            <div class="preview-unsupported">
                <span class="preview-icon"><i data-lucide="paperclip"></i></span>
                <p>{{ _t('docs.preview_unavailable') if _t else 'Vista previa no disponible para este tipo de archivo.' }}</p>
                <a href="/api/documents/{{ document.id }}/download" class="btn btn-primary" download>
                    <i data-lucide="download"></i> {{ _t('docs.download_file') if _t else 'Descargar archivo' }}
                </a>
            </div>
            {% endif %}
        </div>
        <div class="modal-footer">
            <div class="preview-info">
                <span class="info-item">
                    <strong>{{ _t('docs.info_category') if _t else 'Categoria:' }}</strong> {{ categoria_nombres[document.categoria.value] }}
                </span>
                <span class="info-item">
                    <strong>{{ _t('docs.info_size') if _t else 'Tamano:' }}</strong> {{ document.file_size_human }}
                </span>
                <span class="info-item">
                    <strong>{{ _t('docs.info_uploaded') if _t else 'Subido:' }}</strong> {{ document.created_at.strftime('%d/%m/%Y %H:%M') }}
                </span>
                {% if document.sellado %}
                <span class="info-item">
                    <strong>{{ _t('docs.info_sealed') if _t else 'Sellado:' }}</strong> {{ document.fecha_sellado.strftime('%d/%m/%Y %H:%M') if document.fecha_sellado else (_t('docs.yes') if _t else 'Si') }}
                </span>
                {% endif %}
            </div>
            <div class="preview-actions">
                <a href="/api/documents/{{ document.id }}/download" class="btn btn-primary" download>
                    <i data-lucide="download"></i> {{ _t('docs.download') if _t else 'Descargar' }}
                </a>
                <button type="button" class="btn btn-secondary" onclick="closeDocumentPreview()">
                    {{ _t('docs.close') if _t else 'Cerrar' }}
                </button>
            </div>
        </div>
    </div>
</div>
